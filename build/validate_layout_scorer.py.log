> poetry run python3 validate_layout_scorer.py
COMPREHENSIVE LAYOUT SCORER VALIDATION
================================================================================

================================================================================
RUNNING: LAYOUT INPUT CONSISTENCY
============================================================
VALIDATING LAYOUT INPUT CONSISTENCY
============================================================

Test Case 1: Mixed letters and punctuation (your original case)
Letters:    bfnc'"liukpsat,.eormvxgd-?hyjwqz
Positions:  qwertyuiop[asdfghjkl;'zxcvbnm,./
✅ Consistent: 26 characters mapped

Test Case 2: Standard 26-letter alphabet
Letters:    abcdefghijklmnopqrstuvwxyz[';,./
Positions:  qwertyuiop[asdfghjkl;'zxcvbnm,./
✅ Consistent: 26 characters mapped

Test Case 3: Dvorak layout (32 chars)
Letters:    ',.pyfgcrlaoeuidhtns;qjkxbmwvz[/
Positions:  qwertyuiop[asdfghjkl;'zxcvbnm,./
✅ Consistent: 26 characters mapped

================================================================================
RUNNING: SCORER FUNCTIONALITY

============================================================
VALIDATING SCORER FUNCTIONALITY
============================================================

Testing engram scorer...
Loading and normalizing score files...
  Loading item scores from: input/engram/normalized_letter_frequencies_en.csv
  Loading item pair scores from: input/engram/normalized_letter_pair_frequencies_en.csv
  Loading position scores from: input/engram/normalized_key_comfort_scores_24keys.csv
  Loading position-pair scores from: input/engram/normalized_key_pair_comfort_scores_32keys_LvsRpairs.csv
  Loaded 26 item scores
  Loaded 669 item pair scores
  Loaded 24 position scores
  Loaded 652 position-pair scores
  24-key home block coverage: 20/26 keys
  ✓ All positions found in position-pair file
✅ engram: score = 0.005031

Testing dvorak9 scorer...
Loading bigram frequencies from input/dvorak9/normalized_letter_pair_frequencies_en.csv
  Loaded 669 bigram frequencies
Loading key-value data from input/dvorak9/key_pair_scores.csv
  Loaded 1024 key-value pairs
Loaded 512 combination weights from input/dvorak9/speed_weights.csv
Loaded 405 combination weights from input/dvorak9/comfort_weights.csv
✅ dvorak9: score = 0.109408

Testing distance scorer...
✅ distance: score = 0.989146

================================================================================
RUNNING: CROSS-HAND FILTERING

============================================================
VALIDATING CROSS-HAND FILTERING
============================================================

Testing engram cross-hand filtering...
Loading and normalizing score files...
  Loading item scores from: input/engram/normalized_letter_frequencies_en.csv
  Loading item pair scores from: input/engram/normalized_letter_pair_frequencies_en.csv
  Loading position scores from: input/engram/normalized_key_comfort_scores_24keys.csv
  Loading position-pair scores from: input/engram/normalized_key_pair_comfort_scores_32keys_LvsRpairs.csv
  Loaded 26 item scores
  Loaded 669 item pair scores
  Loaded 24 position scores
  Loaded 652 position-pair scores
  24-key home block coverage: 7/8 keys
  ✓ All positions found in position-pair file
Loading and normalizing score files...
  Loading item scores from: input/engram/normalized_letter_frequencies_en.csv
  Loading item pair scores from: input/engram/normalized_letter_pair_frequencies_en.csv
  Loading position scores from: input/engram/normalized_key_comfort_scores_24keys.csv
  Loading position-pair scores from: input/engram/normalized_key_pair_comfort_scores_32keys_LvsRpairs.csv
  Loaded 26 item scores
  Loaded 669 item pair scores
  Loaded 24 position scores
  Loaded 652 position-pair scores
  24-key home block coverage: 7/8 keys
  ✓ All positions found in position-pair file
✅ engram: normal = 0.002388, filtered = 0.001998

Testing dvorak9 cross-hand filtering...
Loading bigram frequencies from input/dvorak9/normalized_letter_pair_frequencies_en.csv
  Loaded 669 bigram frequencies
Loading key-value data from input/dvorak9/key_pair_scores.csv
  Loaded 1024 key-value pairs
Loaded 512 combination weights from input/dvorak9/speed_weights.csv
Loaded 405 combination weights from input/dvorak9/comfort_weights.csv
Loading bigram frequencies from input/dvorak9/normalized_letter_pair_frequencies_en.csv
  Loaded 669 bigram frequencies
Loading key-value data from input/dvorak9/key_pair_scores.csv
  Loaded 1024 key-value pairs
Loaded 512 combination weights from input/dvorak9/speed_weights.csv
Loaded 405 combination weights from input/dvorak9/comfort_weights.csv
✅ dvorak9: normal = 0.096978, filtered = 0.065476

================================================================================
RUNNING: OUTPUT FORMATS

============================================================
VALIDATING OUTPUT FORMATS
============================================================

Testing detailed format...
✅ detailed: 6 lines generated

Testing csv format...
✅ csv: 2 lines generated

Testing score_only format...
✅ score_only: 1 lines generated

================================================================================
RUNNING: DATA FILES

============================================================
VALIDATING DATA FILES
============================================================

Validating engram_scorer data files...
✅ engram_scorer: all data files found

Validating dvorak9_scorer data files...
✅ dvorak9_scorer: all data files found

Validating distance_scorer data files...
✅ distance_scorer: all data files found

================================================================================
RUNNING: EMPIRICAL WEIGHT LOADING

============================================================
VALIDATING EMPIRICAL WEIGHT LOADING
============================================================

Testing speed weights: input/dvorak9/speed_weights.csv
✅ speed weights: 512 combinations loaded
   Range: -0.2016 to 0.0935
   Example: fingers + hands + home_row + strong_fingers: -0.2016
   Example: fingers + hands + home_row + skip_fingers + strong_fingers: -0.2010
   Example: fingers + hands + home_row + skip_fingers: -0.1975

Testing comfort weights: input/dvorak9/comfort_weights.csv
✅ comfort weights: 405 combinations loaded
   Range: -0.1984 to 0.6810
   Example: columns + dont_cross_home: 0.6810
   Example: columns + dont_cross_home + strong_fingers: 0.6079
   Example: columns + dont_cross_home + home_row: 0.5940

================================================================================
RUNNING: COMBINATION DIVERSITY

============================================================
VALIDATING COMBINATION DIVERSITY
============================================================
Testing combination assignment for 17 bigrams...

Found 12 unique combinations:
  1. columns + dont_cross_home + fingers + hands + home_row + skip_fingers + strong_fingers + strum (3 bigrams): he, an, zj
  2. columns + dont_cross_home + fingers + same_row (2 bigrams): wq, xz
  3. columns + dont_cross_home + home_row + same_row (2 bigrams): aa, ss
  4. columns + dont_cross_home + home_row + same_row + strong_fingers (2 bigrams): dd, ff
  5. dont_cross_home + fingers + hands + home_row + skip_fingers + strong_fingers + strum (1 bigrams): th
✅ Good diversity: Most frequent combination used by 17.6% of bigrams

================================================================================
RUNNING: EMPIRICAL SCORING DIFFERENCES

============================================================
VALIDATING EMPIRICAL SCORING DIFFERENCES
============================================================
Testing 3 different layouts...
Loading bigram frequencies from input/dvorak9/normalized_letter_pair_frequencies_en.csv
  Loaded 669 bigram frequencies
Loading key-value data from input/dvorak9/key_pair_scores.csv
  Loaded 1024 key-value pairs
Loaded 512 combination weights from input/dvorak9/speed_weights.csv
Loaded 405 combination weights from input/dvorak9/comfort_weights.csv
✅ layout1: freq=0.535570, speed=0.087374, comfort=0.358188
Loading bigram frequencies from input/dvorak9/normalized_letter_pair_frequencies_en.csv
  Loaded 669 bigram frequencies
Loading key-value data from input/dvorak9/key_pair_scores.csv
  Loaded 1024 key-value pairs
Loaded 512 combination weights from input/dvorak9/speed_weights.csv
Loaded 405 combination weights from input/dvorak9/comfort_weights.csv
✅ layout2: freq=0.549761, speed=0.090723, comfort=0.356471
Loading bigram frequencies from input/dvorak9/normalized_letter_pair_frequencies_en.csv
  Loaded 669 bigram frequencies
Loading key-value data from input/dvorak9/key_pair_scores.csv
  Loaded 1024 key-value pairs
Loaded 512 combination weights from input/dvorak9/speed_weights.csv
Loaded 405 combination weights from input/dvorak9/comfort_weights.csv
✅ layout3: freq=0.820786, speed=0.121968, comfort=0.298216

Checking score differences between layouts...
   frequency: range = 0.285217, std = 0.131235
✅ frequency: meaningful differences found
   speed: range = 0.034593, std = 0.015578
✅ speed: meaningful differences found
   comfort: range = 0.059972, std = 0.027875
✅ comfort: meaningful differences found

================================================================================
RUNNING: LINEAR CORRELATION ABSENCE

============================================================
VALIDATING ABSENCE OF LINEAR CORRELATION
============================================================
Testing correlation across 5 layouts...
Loading bigram frequencies from input/dvorak9/normalized_letter_pair_frequencies_en.csv
  Loaded 669 bigram frequencies
Loading key-value data from input/dvorak9/key_pair_scores.csv
  Loaded 1024 key-value pairs
Loaded 512 combination weights from input/dvorak9/speed_weights.csv
Loaded 405 combination weights from input/dvorak9/comfort_weights.csv
Loading bigram frequencies from input/dvorak9/normalized_letter_pair_frequencies_en.csv
  Loaded 669 bigram frequencies
Loading key-value data from input/dvorak9/key_pair_scores.csv
  Loaded 1024 key-value pairs
Loaded 512 combination weights from input/dvorak9/speed_weights.csv
Loaded 405 combination weights from input/dvorak9/comfort_weights.csv
Loading bigram frequencies from input/dvorak9/normalized_letter_pair_frequencies_en.csv
  Loaded 669 bigram frequencies
Loading key-value data from input/dvorak9/key_pair_scores.csv
  Loaded 1024 key-value pairs
Loaded 512 combination weights from input/dvorak9/speed_weights.csv
Loaded 405 combination weights from input/dvorak9/comfort_weights.csv
Warning: dvorak9 scorer failed: Duplicate positions in layout mapping: ['G', 'F', 'J']
Loading bigram frequencies from input/dvorak9/normalized_letter_pair_frequencies_en.csv
  Loaded 669 bigram frequencies
Loading key-value data from input/dvorak9/key_pair_scores.csv
  Loaded 1024 key-value pairs
Loaded 512 combination weights from input/dvorak9/speed_weights.csv
Loaded 405 combination weights from input/dvorak9/comfort_weights.csv

Correlation analysis (4 layouts):
   Frequency vs Speed:   r = 0.950953
   Frequency vs Comfort: r = 0.171317
   Speed vs Comfort:     r = -0.032705
✅ No perfect correlations - empirical weighting working correctly

================================================================================
RUNNING: EMPIRICAL SCORES PRESENCE

============================================================
VALIDATING EMPIRICAL SCORES PRESENCE
============================================================
Loading bigram frequencies from input/dvorak9/normalized_letter_pair_frequencies_en.csv
  Loaded 669 bigram frequencies
Loading key-value data from input/dvorak9/key_pair_scores.csv
  Loaded 1024 key-value pairs
Loaded 512 combination weights from input/dvorak9/speed_weights.csv
Loaded 405 combination weights from input/dvorak9/comfort_weights.csv
✅ Pure Dvorak Score: 0.798611
✅ Frequency Weighted Score: 0.820786
✅ Speed Weighted Score: 0.121968
✅ Comfort Weighted Score: 0.298216
✅ 2/2 empirical scores present

================================================================================
VALIDATION SUMMARY
================================================================================
✅ PASS   Layout Input Consistency
✅ PASS   Scorer Functionality
✅ PASS   Cross-Hand Filtering
✅ PASS   Output Formats
✅ PASS   Data Files
✅ PASS   Empirical Weight Loading
✅ PASS   Combination Diversity
✅ PASS   Empirical Scoring Differences
✅ PASS   Linear Correlation Absence
✅ PASS   Empirical Scores Presence

Overall: 10/10 tests passed
🎉 ALL VALIDATIONS PASSED!
